<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MedMate ‚Äî –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏–∏</title>
<style>
:root{
  --bg1:#0f172a10; --card:#ffffff; --accent1:#5eead4; --accent2:#60a5fa;
  --accent:#2563eb; --accent-2:#06b6d4; --good:#10b981; --bad:#ef4444;
  --muted:#6b7280; --glass: rgba(255,255,255,0.6);
  --shadow: 0 12px 30px rgba(2,6,23,0.08);
  --radius:14px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Roboto, Arial;background:linear-gradient(180deg,#eaf2ff 0%, #ffffff 50%);color:#0f172a}
.container{max-width:1100px;margin:18px auto;padding:18px}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px}
.brand{display:flex;gap:12px;align-items:center}
.logo{
  width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,var(--accent2),var(--accent));
  display:flex;align-items:center;justify-content:center;color:white;font-weight:700;font-size:20px;box-shadow:var(--shadow)
}
.title{line-height:1}
.title h1{margin:0;font-size:20px}
.title p{margin:2px 0 0;color:var(--muted);font-size:13px}

/* Top controls */
.controls{display:flex;gap:10px;align-items:center}
.xp{background:linear-gradient(90deg,#d9f99d,#86efac);padding:8px 12px;border-radius:999px;font-weight:700}
.level{background:linear-gradient(90deg,#bfdbfe,#60a5fa);padding:8px 12px;border-radius:999px;font-weight:700;color:white}
.streak{background:linear-gradient(90deg,#fde68a,#fca5a5);padding:8px 12px;border-radius:999px;font-weight:700}
.coins{background:linear-gradient(90deg,#facc15,#fcd34d);padding:8px 12px;border-radius:999px;font-weight:700;color:#1f2937}

/* main layout */
.grid{display:grid;grid-template-columns:260px 1fr;gap:16px;margin-top:18px}
.sidebar{position:sticky;top:18px;background:var(--card);padding:14px;border-radius:var(--radius);box-shadow:var(--shadow)}
.nav{display:flex;flex-direction:column;gap:8px}
.tab{padding:10px;border-radius:10px;cursor:pointer;border:1px solid rgba(2,6,23,0.04);display:flex;align-items:center;gap:10px}
.tab.active{background:linear-gradient(90deg,#eff6ff,#fff);border:1px solid rgba(37,99,235,0.12);box-shadow:0 10px 30px rgba(59,130,246,0.08)}
.badge{margin-left:auto;background:#eef2ff;color:var(--accent);padding:6px 8px;border-radius:999px;font-weight:700;font-size:12px}

/* main area */
.main{min-height:520px}
.hero{padding:18px;border-radius:14px;background:linear-gradient(180deg,#ffffff,#f8fafc);box-shadow:var(--shadow);display:flex;gap:18px;align-items:center}
.hero .left{flex:1}
.hero .right{width:240px;text-align:center}
.hero h2{margin:0;font-size:18px}
.hero p{margin:6px 0 0;color:var(--muted)}

.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px;margin-top:14px}
.card{background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow);border:1px solid rgba(2,6,23,0.03)}
.card h3{margin:0 0 8px}
.small{color:var(--muted);font-size:13px}

/* theory UI */
.question{font-weight:800;margin-bottom:12px;font-size:18px}
.options{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.option{background:linear-gradient(180deg,#fff,#fbfdff);padding:12px;border-radius:10px;border:1px solid rgba(2,6,23,0.04);cursor:pointer;transition:transform .12s ease,box-shadow .12s}
.option:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(2,6,23,0.06)}
.option.correct{border-color:rgba(16,185,129,0.2);box-shadow:0 12px 30px rgba(16,185,129,0.06)}
.option.wrong{border-color:rgba(239,68,68,0.12);box-shadow:0 12px 30px rgba(239,68,68,0.06)}

/* practice station format */
.station{
  display:grid;grid-template-columns:1fr 360px;gap:12px;align-items:start
}
.station-left{padding:12px}
.station-right{padding:12px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbfdff);border:1px solid rgba(2,6,23,0.03)}
.steps{list-style:none;padding:0;margin:0}
.steps li{display:flex;align-items:center;gap:10px;padding:10px;border-radius:10px;margin-bottom:8px;background:white;border:1px solid rgba(2,6,23,0.03)}
.steps li.done{background:linear-gradient(90deg,#ecfdf5,#f0fff4);border-color:rgba(16,185,129,0.12)}

/* progress map */
#progressMap div{transition:all .4s ease;text-align:center;}

/* cases */
.case-step{padding:12px;border-radius:10px;margin-bottom:10px;background:white;border:1px solid rgba(2,6,23,0.03)}
.case-opts{display:flex;flex-wrap:wrap;gap:8px;margin-top:8px}

/* footer & misc */
.footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
.center{display:flex;align-items:center;justify-content:center}
.progress{height:12px;background:#f1f5f9;border-radius:999px;overflow:hidden}
.progress > i{display:block;height:100%;width:0%;background:linear-gradient(90deg,#34d399,#60a5fa);transition:width .5s ease}

/* responsive */
@media (max-width:980px){.grid{grid-template-columns:1fr}.station{grid-template-columns:1fr}.hero .right{display:none}}
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <div class="logo">MM</div>
        <div class="title">
          <h1>MedMate ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞–∫–∫—Ä–µ–¥–∏—Ç–∞—Ü–∏–∏</h1>
          <p class="small">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è, —Å—Ç–∞–Ω—Ü–∏–∏ –∏ –∫–µ–π—Å—ã ‚Äî –≤—Å—ë –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏</p>
        </div>
      </div>

      <div class="controls">
        <div class="xp" id="xpBadge">XP: 0</div>
        <div class="level" id="levelBadge">Lvl 1 üë∂</div>
        <div class="streak" id="streakBadge">Streak: 0</div>
        <div class="coins" id="coinsBadge">üíä 0</div>
      </div>
    </div>

    <div class="grid">
      <!-- SIDEBAR -->
      <aside class="sidebar">
        <div style="display:flex;gap:10px;align-items:center;margin-bottom:12px">
          <div style="flex:1">
            <div class="small">–í—ã–±—Ä–∞–Ω –∫—É—Ä—Å</div>
            <div style="font-weight:800" id="chosenCourse">‚Äî</div>
          </div>
          <div>
            <button class="tab" onclick="openCourseChooser()">–°–º–µ–Ω–∏—Ç—å</button>
          </div>
        </div>

        <nav class="nav">
          <div class="tab active" data-tab="home" onclick="switchTab('home')">üè† –ì–ª–∞–≤–Ω–æ–µ <span class="badge">NEW</span></div>
          <div class="tab" data-tab="map" onclick="switchTab('map')">üó∫Ô∏è –ö–∞—Ä—Ç–∞</div>
          <div class="tab" data-tab="theory" onclick="switchTab('theory')">üß† –¢–µ–æ—Ä–∏—è</div>
          <div class="tab" data-tab="practice" onclick="switchTab('practice')">üíâ –ü—Ä–∞–∫—Ç–∏–∫–∞</div>
          <div class="tab" data-tab="cases" onclick="switchTab('cases')">üìù –ö–µ–π—Å—ã</div>
          <div class="tab" data-tab="leaderboard" onclick="switchTab('leaderboard')">üèÜ –†–µ–π—Ç–∏–Ω–≥</div>
          <div class="tab" data-tab="profile" onclick="switchTab('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
        </nav>

        <div style="margin-top:12px" class="small">
          <div style="margin-bottom:6px">–ü—Ä–æ–≥—Ä–µ—Å—Å –∫—É—Ä—Å–∞</div>
          <div class="progress"><i id="globalProgress" style="width:0%"></i></div>
        </div>
      </aside>

      <!-- MAIN -->
      <main class="main" id="mainArea">
        <!-- HOME -->
        <section id="tab-home" class="card">
          <div class="hero">
            <div class="left">
              <h2 id="welcomeTitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ MedMate</h2>
              <p class="small">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫—É—Ä—Å, –∑–∞—Ç–µ–º –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ –º–æ–¥—É–ª–∏: —Ç–µ–æ—Ä–∏—è, –ø—Ä–∞–∫—Ç–∏–∫–∞ –∏ –∫–µ–π—Å—ã. –í—Å—ë —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ.</p>

              <div style="margin-top:12px;display:flex;gap:8px">
                <button class="btn" style="padding:10px 14px;border-radius:10px;background:linear-gradient(90deg,var(--accent-2),var(--accent)) ;color:white" onclick="openCourseChooser()">–í—ã–±—Ä–∞—Ç—å –∫—É—Ä—Å</button>
                <button class="btn ghost" style="background:transparent;border:1px solid rgba(37,99,235,0.08);" onclick="switchTab('theory')">–ü–µ—Ä–µ–π—Ç–∏ –≤ —Ç–µ–æ—Ä–∏—é</button>
              </div>
            </div>
            <div class="right">
              <div style="background:linear-gradient(180deg,#fff,#f8fafc);padding:12px;border-radius:10px;box-shadow:var(--shadow)">
                <div style="font-weight:800">–¢–≤–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å</div>
                <div style="margin-top:8px" class="small">–û—á–∫–∏ –∏ –±–µ–π–¥–∂–∏ ‚Äî –º–æ—Ç–∏–≤–∞—Ü–∏—è –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏</div>
                <div style="margin-top:12px"><div class="small">–û—á–∫–∏: <span id="points">0</span></div>
                <div style="margin-top:8px"><div class="small">Combo: <span id="combo">0</span></div></div></div>
              </div>
            </div>
          </div>

          <div class="cards">
            <div class="card">
              <h3>–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h3>
              <div class="small">–ü—Ä–æ–π–¥–∏—Ç–µ 3 –≤–æ–ø—Ä–æ—Å–∞ —Ç–µ–æ—Ä–∏–∏ –∏ 1 —Å—Ç–∞–Ω—Ü–∏—é ‚Äî –ø–æ–ª—É—á–∏—Ç–µ –±–æ–Ω—É—Å–Ω—ã–π –±–µ–π–¥–∂ "Starter".</div>
              <div style="margin-top:12px"><button class="btn" onclick="startQuickRun()">–ó–∞–ø—É—Å—Ç–∏—Ç—å Quick Run</button></div>
            </div>

            <div class="card">
              <h3>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
              <div class="small">–°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ: —Å—Ç–∞–Ω—Ü–∏–∏ –∏–º–µ—é—Ç —á–µ–∫-–ª–∏—Å—Ç—ã –∏ –≤–∏–¥–µ–æ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.</div>
            </div>

            <div class="card">
              <h3>–ö–µ–π—Å—ã</h3>
              <div class="small">–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ ‚Äî –≤—ã–±–∏—Ä–∞–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–ª—É—á–∞–π –æ—á–∫–∏.</div>
              <div style="margin-top:10px"><button class="btn ghost" onclick="switchTab('cases')">–û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å—ã</button></div>
            </div>
          </div>
        </section>

        <!-- PROGRESS MAP -->
        <section id="tab-map" class="card hide">
          <h3>–ö–∞—Ä—Ç–∞ –æ–±—É—á–µ–Ω–∏—è</h3>
          <div id="progressMap" style="display:flex;gap:12px;align-items:center;overflow-x:auto;padding:12px"></div>
        </section>

        <!-- THEORY -->
        <section id="tab-theory" class="card hide">
          <div id="theoryArea"></div>
        </section>

        <!-- PRACTICE -->
        <section id="tab-practice" class="card hide">
          <div id="practiceArea"></div>
        </section>

        <!-- CASES -->
        <section id="tab-cases" class="card hide">
          <div id="casesArea"></div>
        </section>

        <!-- LEADERBOARD -->
        <section id="tab-leaderboard" class="card hide">
          <h3>–¢–æ–ø —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h3>
          <div id="leaderboardList"></div>
        </section>

        <!-- PROFILE -->
        <section id="tab-profile" class="card hide">
          <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
          <div class="small">–ü–æ–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å –ª–æ–∫–∞–ª—å–Ω—ã–π ‚Äî –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –∏ —Å–µ—Ä–≤–µ—Ä.</div>
          <div style="margin-top:12px">
            <div class="small">–ò–º—è: <strong id="profileName">Student</strong></div>
            <div class="small" style="margin-top:8px">–û—á–∫–∏: <strong id="profilePoints">0</strong></div>
            <div style="margin-top:8px">üíä –ú–µ–¥-–∫–æ–∏–Ω—ã: <span id="coinsCount">0</span></div>
            <div style="margin-top:12px"><button class="btn ghost" onclick="resetAll()">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button></div>
          </div>
        </section>

      </main>
    </div>

    <div class="footer">MedMate ‚Äî –ø—Ä–æ—Ç–æ—Ç–∏–ø –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏. –í–∏–¥–µ–æ–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ —Ä–∞–∑–¥–µ–ª –ü—Ä–∞–∫—Ç–∏–∫–∏.</div>
  </div>

<script>
// ===== STATE =====
let state = JSON.parse(localStorage.getItem('medmateState') || '{}');
state.xp = state.xp||0;
state.level = state.level||1;
state.streak = state.streak||0;
state.coins = state.coins||0;
state.completedStations = state.completedStations||{};
state.currentCase = null;
state.course = state.course||null;
state.points = state.points||0;
state.combo = state.combo||0;

// ===== CONTENT =====
const COURSES = ['–ö–∞—Ä–¥–∏–æ–ª–æ–≥–∏—è','–ù–µ–≤—Ä–æ–ª–æ–≥–∏—è','–¢–µ—Ä–∞–ø–∏—è'];
const CONTENT = {
  theory:[
    {q:'–ß—Ç–æ –∏–∑–º–µ—Ä—è–µ—Ç –ø—É–ª—å—Å?', opts:['–î–∞–≤–ª–µ–Ω–∏–µ','–ß–∞—Å—Ç–æ—Ç—É —Å–µ—Ä–¥–µ—á–Ω—ã—Ö —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π'], ans:1},
    {q:'–ß—Ç–æ —Ç–∞–∫–æ–µ –≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è?', opts:['–í—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ','–ù–∏–∑–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ'], ans:0},
    {q:'–ö–∞–∫–∞—è –∞—Ä—Ç–µ—Ä–∏—è —Å–∞–º–∞—è –∫—Ä—É–ø–Ω–∞—è?', opts:['–ê–æ—Ä—Ç–∞','–õ—ë–≥–æ—á–Ω–∞—è'], ans:0}
  ],
  practice:[
    {id:'slr', name:'–°—Ç–∞–Ω—Ü–∏—è –°–õ–†', steps:['–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞','–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–Ω–∞–Ω–∏—è','–°–µ—Ä–¥–µ—á–Ω–æ-–ª—ë–≥–æ—á–Ω–∞—è —Ä–µ–∞–Ω–∏–º–∞—Ü–∏—è']},
    {id:'ausc', name:'–°—Ç–∞–Ω—Ü–∏—è –ê—É—Å–∫—É–ª—å—Ç–∞—Ü–∏—è', steps:['–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞','–°–ª—É—à–∞–µ–º —Å–µ—Ä–¥—Ü–µ','–ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã']}
  ],
  cases:[
    {id:'case1', title:'–ü–∞—Ü–∏–µ–Ω—Ç —Å –±–æ–ª—å—é –≤ –≥—Ä—É–¥–∏', steps:[
      {text:'–ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞?', options:['–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É–ª—å—Å','–î–∞—Ç—å —Ç–∞–±–ª–µ—Ç–∫—É'], correct:0},
      {text:'–°–ª–µ–¥—É—é—â–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ?', options:['–í—ã–∑–≤–∞—Ç—å —Å–∫–æ—Ä—É—é','–ù–∞–ª–æ–∂–∏—Ç—å –≥–∏–ø—Å'], correct:0}
    ]}
  ]
};
const LEVELS = [
  {lvl:1,name:'üë∂ –°—Ç—É–¥–µ–Ω—Ç'},
  {lvl:2,name:'ü©∫ –ò–Ω—Ç–µ—Ä–Ω'},
  {lvl:3,name:'üíâ –ú–æ–ª–æ–¥–æ–π –≤—Ä–∞—á'},
  {lvl:4,name:'üß† –≠–∫—Å–ø–µ—Ä—Ç'}
];
const LEADERBOARD = [
  {name:'–ê–ª—å—Ñ–∏—è –ú–∏–¥—Ö–∞—Ç–æ–≤–Ω–∞', points:120, avatar:'üë©‚Äç‚öïÔ∏è', faculty:'üíô'},
  {name:'–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', points:110, avatar:'üë®‚Äç‚öïÔ∏è', faculty:'‚ù§Ô∏è'}
];

// ===== STORAGE =====
function saveState(){ localStorage.setItem('medmateState', JSON.stringify(state)); updateUI();}

// ===== UI =====
function switchTab(tab){
  document.querySelectorAll('.main > section').forEach(s=>s.classList.add('hide'));
  document.getElementById('tab-'+tab).classList.remove('hide');
  document.querySelectorAll('.nav .tab').forEach(t=>t.classList.remove('active'));
  document.querySelector('.nav .tab[data-tab="'+tab+'"]').classList.add('active');
}
function openCourseChooser(){
  const c = prompt('–í—ã–±–µ—Ä–∏—Ç–µ –∫—É—Ä—Å:\n'+COURSES.join('\n'),state.course||'');
  if(coursesIncludes(c)){ setCourse(c);}
}
function coursesIncludes(c){return COURSES.includes(c);}
function setCourse(c){
  state.course = c; saveState();
  document.getElementById('chosenCourse').innerText=c;
  renderProgressMap();
  switchTab('map');
  renderTheory();
  renderPractice();
  renderCases();
  renderLeaderboard();
}
function showToast(msg){alert(msg);}
function addPoints(n){
  state.points += n;
  state.combo++;
  state.xp += n;
  updateLevel();
  saveState();
}
function resetCombo(){state.combo=0; saveState();}
function updateLevel(){
  let nextLvl = LEVELS.filter(l=>state.xp>=l.lvl*30).pop();
  state.level = nextLvl ? nextLvl.lvl : 1;
}

// ===== MAP =====
function renderProgressMap(){
  if(!state.course) return;
  const stations = CONTENT.practice.map(st=>st.id);
  const container = document.getElementById('progressMap');
  container.innerHTML = '';
  stations.forEach(id=>{
    const done = state.completedStations[id]?.length === CONTENT.practice.find(s=>s.id===id).steps.length;
    const el = document.createElement('div');
    el.style.padding='12px 18px';
    el.style.borderRadius='12px';
    el.style.background=done?'linear-gradient(90deg,#34d399,#60a5fa)':'#e2e8f0';
    el.style.color=done?'white':'#1f2937';
    el.style.fontWeight='700';
    el.style.cursor='pointer';
    el.innerText = id.toUpperCase();
    if(done) el.innerHTML += ' üéâ';
    el.onclick = ()=>openStation(id);
    container.appendChild(el);
  });
}

// ===== THEORY =====
function renderTheory(){
  const container = document.getElementById('theoryArea');
  container.innerHTML='';
  CONTENT.theory.forEach((q,i)=>{
    const div = document.createElement('div'); div.className='card'; div.style.marginBottom='12px';
    div.innerHTML = `<div class="question">${q.q}</div><div class="options">${q.opts.map((o,oi)=>`<div class="option" onclick="checkTheory(${i},${oi},this)">${o}</div>`).join('')}</div>`;
    container.appendChild(div);
  });
}
function checkTheory(qidx,optIdx,el){
  const q = CONTENT.theory[qidx];
  if(optIdx===q.ans){ el.classList.add('correct'); addPoints(10); showToast('+10 XP');}
  else{el.classList.add('wrong'); resetCombo();}
}

// ===== PRACTICE =====
function renderPractice(){
  const container = document.getElementById('practiceArea');
  container.innerHTML='';
  CONTENT.practice.forEach(st=>{
    const div = document.createElement('div'); div.className='card station';
    div.innerHTML=`<div class="station-left"><h4>${st.name}</h4><ul class="steps">${st.steps.map(s=>`<li>${s}</li>`).join('')}</ul></div>
    <div class="station-right" id="station-${st.id}"><div class="small">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —à–∞–≥, —á—Ç–æ–±—ã –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–π</div></div>`;
    container.appendChild(div);
  });
}
function openStation(id){
  const st = CONTENT.practice.find(s=>s.id===id);
  const container = document.getElementById('station-'+id);
  container.innerHTML='';
  st.steps.forEach((s,idx)=>{
    const btn = document.createElement('button'); btn.innerText=s; btn.style.margin='6px'; btn.onclick=()=>{
      state.completedStations[id] = state.completedStations[id]||[];
      if(!state.completedStations[id].includes(idx)){
        state.completedStations[id].push(idx);
        addPoints(5); btn.innerText='‚úî '+s;
        renderProgressMap();
        showToast(`+5 XP ‚Äî —à–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω`);
      }
    };
    container.appendChild(btn);
  });
}

// ===== CASES =====
function renderCases(){
  const container = document.getElementById('casesArea');
  container.innerHTML='';
  CONTENT.cases.forEach(c=>{
    const div = document.createElement('div'); div.className='card';
    div.innerHTML = `<h4>${c.title}</h4><div>${c.steps.map((st,idx)=>`<div class="case-step"><div>${st.text}</div><div class="case-opts">${st.options.map((o,oi)=>`<button onclick="checkCase(${c.id==='case1'?0:0},${idx},${oi},this)">${o}</button>`).join('')}</div></div>`).join('')}</div>`;
    container.appendChild(div);
  });
}
function checkCase(caseIdx,stepIdx,optIdx,btn){
  const correct = CONTENT.cases[caseIdx].steps[stepIdx].correct===optIdx;
  if(correct){btn.style.background='#10b981'; addPoints(12);}
  else{btn.style.background='#ef4444'; resetCombo();}
  btn.disabled=true;
}

// ===== LEADERBOARD =====
function renderLeaderboard(){
  const container = document.getElementById('leaderboardList');
  container.innerHTML='';
  LEADERBOARD.forEach(s=>{
    const el = document.createElement('div');
    el.style.display='flex'; el.style.alignItems='center'; el.style.gap='8px'; el.style.marginBottom='6px';
    el.innerHTML = `<span>${s.avatar}</span><strong>${s.name}</strong> ${s.faculty} ‚Äî ${s.points} –æ—á–∫–æ–≤ üî•`;
    container.appendChild(el);
  });
}

// ===== UI UPDATE =====
function updateUI(){
  document.getElementById('xpBadge').innerText = 'XP: '+state.xp;
  const rankName = LEVELS.filter(l=>state.level>=l.lvl).pop()?.name||'üë∂';
  document.getElementById('levelBadge').innerText = `Lvl ${state.level} ${rankName}`;
  document.getElementById('streakBadge').innerText = `Streak: ${state.streak}`;
  document.getElementById('coinsBadge').innerText = `üíä ${state.coins}`;
  document.getElementById('points').innerText = state.points;
  document.getElementById('combo').innerText = state.combo;
  document.getElementById('profilePoints').innerText = state.points;
  document.getElementById('coinsCount').innerText = state.coins;
}

// ===== QUICK RUN =====
function startQuickRun(){
  if(!state.course){ alert('–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –∫—É—Ä—Å'); return;}
  renderTheory();
  renderPractice();
  renderCases();
  showToast('Quick Run –∑–∞–ø—É—â–µ–Ω! –ü—Ä–æ—Ö–æ–¥–∏—Ç–µ —à–∞–≥–∏.');
}

// ===== RESET =====
function resetAll(){if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å?')){localStorage.removeItem('medmateState'); location.reload();}}

// ===== INIT =====
updateUI();
if(state.course){ setCourse(state.course); }else{switchTab('home');}
</script>
</body>
</html>
