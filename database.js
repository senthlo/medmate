// ===== БАЗА ДАННЫХ ВОПРОСОВ =====
const QuestionDatabase = {
    // Терапия - 120 вопросов
    therapy: [
        {
            id: 1,
            question: "Какой препарат является препаратом выбора для купирования гипертонического криза без осложнений?",
            options: [
                "Каптоприл 25 мг сублингвально",
                "Нифедипин 10 мг сублингвально",
                "Клонидин 0,01% в/в",
                "Фуросемид 40 мг в/в"
            ],
            correct: 0,
            explanation: "Каптоприл - препарат выбора при неосложненном гипертоническом кризе благодаря быстрому началу действия и хорошей переносимости."
        },
        {
            id: 2,
            question: "Основной диагностический критерий острого коронарного синдрома:",
            options: [
                "Подъем сегмента ST на ЭКГ",
                "Боль за грудиной длительностью более 20 минут",
                "Повышение уровня тропонинов",
                "Все перечисленное"
            ],
            correct: 3,
            explanation: "Диагноз ОКС устанавливается при наличии клиники, изменений ЭКГ и повышения кардиоспецифических маркеров."
        },
        {
            id: 3,
            question: "Препарат выбора для лечения внебольничной пневмонии у пациента без сопутствующих заболеваний:",
            options: [
                "Амоксициллин",
                "Цефтриаксон",
                "Азитромицин",
                "Левофлоксацин"
            ],
            correct: 0,
            explanation: "Амоксициллин является препаратом первой линии при внебольничной пневмонии у пациентов без факторов риска."
        },
        {
            id: 4,
            question: "Наиболее частый возбудитель острого бронхита:",
            options: [
                "Вирусы",
                "Streptococcus pneumoniae",
                "Haemophilus influenzae",
                "Mycoplasma pneumoniae"
            ],
            correct: 0,
            explanation: "В 85-95% случаев острый бронхит вызывается вирусами (риновирусы, вирусы гриппа, аденовирусы)."
        },
        {
            id: 5,
            question: "Целевой уровень АД у пациента с сахарным диабетом и артериальной гипертензией:",
            options: [
                "< 130/80 мм рт.ст.",
                "< 140/90 мм рт.ст.",
                "< 150/90 мм рт.ст.",
                "< 160/100 мм рт.ст."
            ],
            correct: 0,
            explanation: "У пациентов с СД и АГ целевой уровень АД составляет < 130/80 мм рт.ст. для снижения риска осложнений."
        },
        {
            id: 6,
            question: "Основной метод диагностики ХОБЛ:",
            options: [
                "Спирометрия",
                "Рентгенография органов грудной клетки",
                "КТ грудной клетки",
                "Анализ мокроты"
            ],
            correct: 0,
            explanation: "Спирометрия с бронхолитической пробой - золотой стандарт диагностики ХОБЛ."
        },
        {
            id: 7,
            question: "Препарат выбора для купирования приступа бронхиальной астмы:",
            options: [
                "Сальбутамол",
                "Ипратропия бромид",
                "Будесонид",
                "Теофиллин"
            ],
            correct: 0,
            explanation: "Сальбутамол - β2-агонист короткого действия, препарат первой линии для купирования приступа БА."
        },
        {
            id: 8,
            question: "Наиболее информативный метод диагностики ТЭЛА:",
            options: [
                "КТ-ангиография легочных артерий",
                "Перфузионная сцинтиграфия легких",
                "ЭхоКГ",
                "Д-димер"
            ],
            correct: 0,
            explanation: "КТ-ангиография - наиболее точный метод визуализации тромбов в легочных артериях."
        },
        {
            id: 9,
            question: "Целевой уровень ХС ЛПНП у пациента с ИБС:",
            options: [
                "< 1,8 ммоль/л",
                "< 2,5 ммоль/л",
                "< 3,0 ммоль/л",
                "< 4,0 ммоль/л"
            ],
            correct: 0,
            explanation: "У пациентов высокого риска (ИБС) целевой уровень ХС ЛПНП составляет < 1,8 ммоль/л."
        },
        {
            id: 10,
            question: "Основной механизм действия ингибиторов АПФ:",
            options: [
                "Блокирование превращения ангиотензина I в ангиотензин II",
                "Блокирование рецепторов ангиотензина II",
                "Подавление синтеза альдостерона",
                "Стимуляция брадикининов"
            ],
            correct: 0,
            explanation: "ИАПФ блокируют ангиотензин-превращающий фермент, предотвращая образование ангиотензина II."
        }
        // ... и так далее до 120 вопросов по терапии
    ],

    // Хирургия - 100 вопросов
    surgery: [
        {
            id: 1,
            question: "Наиболее информативный метод диагностики острого аппендицита:",
            options: [
                "Клиническое обследование",
                "УЗИ органов брюшной полости",
                "КТ брюшной полости",
                "Диагностическая лапароскопия"
            ],
            correct: 0,
            explanation: "Клиническое обследование опытным хирургом остается наиболее информативным методом диагностики."
        },
        {
            id: 2,
            question: "Основной симптом прободной язвы желудка:",
            options: [
                "Кинжальная боль в эпигастрии",
                "Тошнота и рвота",
                "Вздутие живота",
                "Задержка стула"
            ],
            correct: 0,
            explanation: "Внезапная 'кинжальная' боль в эпигастрии - патогномоничный симптом прободения язвы."
        },
        {
            id: 3,
            question: "Показание к экстренной операции при ущемленной грыже:",
            options: [
                "Некроз ущемленного органа",
                "Высокий риск перитонита",
                "Невозможность вправления",
                "Все перечисленное"
            ],
            correct: 3,
            explanation: "Все перечисленные состояния являются показаниями к экстренному оперативному вмешательству."
        }
        // ... и так далее для хирургии
    ],

    // Педиатрия - 80 вопросов
    pediatrics: [
        {
            id: 1,
            question: "Препарат выбора для жаропонижающей терапии у детей:",
            options: [
                "Парацетамол",
                "Ибупрофен",
                "Аспирин",
                "Метамизол"
            ],
            correct: 0,
            explanation: "Парацетамол - препарат первой линии для снижения температуры у детей."
        }
        // ... и так далее для педиатрии
    ],

    // Реанимация - 100 вопросов
    reanimation: [
        {
            id: 1,
            question: "Соотношение компрессий и вдохов при проведении СЛР одним спасателем:",
            options: [
                "30:2",
                "15:2",
                "5:1",
                "3:1"
            ],
            correct: 0,
            explanation: "При проведении СЛР одним спасателем рекомендуется соотношение 30 компрессий к 2 вдохам."
        }
        // ... и так далее для реанимации
    ],

    // Неврология - 50 вопросов
    neurology: [
        {
            id: 1,
            question: "Препарат выбора для тромболитической терапии при ишемическом инсульте:",
            options: [
                "Алтеплаза",
                "Стрептокиназа",
                "Урокиназа",
                "Гепарин"
            ],
            correct: 0,
            explanation: "Алтеплаза - единственный препарат, одобренный для тромболитической терапии при ишемическом инсульте."
        }
        // ... и так далее для неврологии
    ],

    // Фармакология - 50 вопросов
    pharmacology: [
        {
            id: 1,
            question: "Механизм действия метформина:",
            options: [
                "Подавление глюконеогенеза в печени",
                "Стимуляция секреции инсулина",
                "Замедление всасывания углеводов",
                "Все перечисленное"
            ],
            correct: 0,
            explanation: "Основной механизм действия метформина - подавление глюконеогенеза в печени."
        }
        // ... и так далее для фармакологии
    ]
};

// ===== БАЗА ДАННЫХ ПРАКТИЧЕСКИХ СТАНЦИЙ =====
const StationsDatabase = {
    nurse: [
        {
            id: 1,
            title: "Измерение артериального давления",
            description: "Правильная техника измерения АД механическим тонометром",
            timeLimit: 300, // 5 минут
            checklist: [
                "Подготовить тонометр и фонендоскоп",
                "Усадить пациента в удобное положение",
                "Наложить манжету на плечо на 2-3 см выше локтевого сгиба",
                "Определить место пульсации плечевой артерии",
                "Накачать манжету до исчезновения пульса + 30 мм рт.ст.",
                "Медленно выпускать воздух (2-3 мм рт.ст./сек)",
                "Зафиксировать появление тонов (систолическое АД)",
                "Зафиксировать исчезновение тонов (диастолическое АД)",
                "Записать результаты измерения",
                "Поблагодарить пациента"
            ]
        },
        {
            id: 2,
            title: "Внутримышечная инъекция",
            description: "Техника выполнения внутримышечной инъекции в верхний наружный квадрант ягодицы",
            timeLimit: 420, // 7 минут
            checklist: [
                "Подготовить рабочее место и препарат",
                "Вымыть руки, надеть перчатки",
                "Проверить название, дозу и срок годности препарата",
                "Набрать лекарственный препарат в шприц",
                "Обработать место инъекции антисептиком",
                "Определить верхний наружный квадрант ягодицы",
                "Ввести иглу под углом 90 градусов на 2/3 длины",
                "Потянуть поршень на себя (аспирационная проба)",
                "Медленно ввести препарат",
                "Извлечь иглу, прижать ватный шарик с антисептиком"
            ]
        },
        {
            id: 3,
            title: "Сердечно-легочная реанимация",
            description: "Базовая сердечно-легочная реанимация на фантоме",
            timeLimit: 600, // 10 минут
            checklist: [
                "Оценить безопасность места происшествия",
                "Проверить сознание пациента",
                "Вызвать скорую помощь",
                "Открыть дыхательные пути",
                "Проверить дыхание (10 секунд)",
                "Начать компрессии грудной клетки",
                "Соотношение 30:2 (компрессии:вдохи)",
                "Глубина компрессий 5-6 см",
                "Частота 100-120 компрессий в минуту",
                "Продолжать до прибытия помощи"
            ]
        },
        {
            id: 4,
            title: "Наложение повязки на рану",
            description: "Техника наложения асептической повязки",
            timeLimit: 300,
            checklist: [
                "Подготовить перевязочный материал",
                "Вымыть руки, надеть перчатки",
                "Обработать кожу вокруг раны антисептиком",
                "Наложить стерильную салфетку на рану",
                "Закрепить повязку бинтом",
                "Проверить надежность фиксации",
                "Убедиться в отсутствии сдавления",
                "Дать рекомендации по уходу",
                "Записать в медицинскую документацию"
            ]
        },
        {
            id: 5,
            title: "Измерение температуры тела",
            description: "Правильная техника измерения температуры в подмышечной впадине",
            timeLimit: 240,
            checklist: [
                "Подготовить термометр",
                "Проверить целостность термометра",
                "Протереть подмышечную впадину насухо",
                "Поместить термометр в подмышечную впадину",
                "Попросить пациента прижать руку к туловищу",
                "Измерять температуру 10 минут",
                "Извлечь термометр, считать показания",
                "Продезинфицировать термометр",
                "Записать результат",
                "Сообщить результат пациенту"
            ]
        }
    ],
    doctor: [
        {
            id: 1,
            title: "Электрокардиография",
            description: "Снятие и интерпретация стандартной ЭКГ в 12 отведениях",
            timeLimit: 600,
            checklist: [
                "Подготовить электрокардиограф",
                "Объяснить пациенту процедуру",
                "Обработать места наложения электродов",
                "Наложить электроды на конечности",
                "Наложить грудные электроды",
                "Записать ЭКГ в 12 отведениях",
                "Оценить ритм и частоту сердечных сокращений",
                "Проанализировать зубцы и интервалы",
                "Выявить возможные нарушения",
                "Сформулировать заключение"
            ]
        },
        {
            id: 2,
            title: "Пальпация живота",
            description: "Методика глубокой пальпации органов брюшной полости",
            timeLimit: 480,
            checklist: [
                "Подготовить пациента к осмотру",
                "Провести поверхностную пальпацию",
                "Определить зоны болезненности",
                "Пропальпировать сигмовидную кишку",
                "Пропальпировать слепую кишку",
                "Пропальпировать поперечно-ободочную кишку",
                "Пропальпировать печень",
                "Пропальпировать селезенку",
                "Пропальпировать поджелудочную железу",
                "Проверить симптомы раздражения брюшины"
            ]
        },
        {
            id: 3,
            title: "Аускультация легких",
            description: "Методика аускультации легких и оценка дыхательных шумов",
            timeLimit: 420,
            checklist: [
                "Подготовить фонендоскоп",
                "Посадить пациента в удобное положение",
                "Провести сравнительную аускультацию",
                "Оценить везикулярное дыхание",
                "Выявить наличие хрипов",
                "Оценить бронхиальное дыхание",
                "Определить крепитацию при наличии",
                "Выявить шум трения плевры",
                "Сопоставить данные с клинической картиной",
                "Сформулировать аускультативную картину"
            ]
        },
        {
            id: 4,
            title: "Неврологический осмотр",
            description: "Стандартный неврологический осмотр",
            timeLimit: 600,
            checklist: [
                "Оценить сознание и ориентацию",
                "Проверить черепно-мозговые нервы",
                "Оценить мышечную силу",
                "Проверить мышечный тонус",
                "Оценить координацию движений",
                "Проверить поверхностную чувствительность",
                "Проверить глубокую чувствительность",
                "Оценить рефлексы",
                "Проверить менингеальные симптомы",
                "Сформулировать неврологический статус"
            ]
        },
        {
            id: 5,
            title: "Инъекция в сустав",
            description: "Техника внутрисуставного введения препаратов",
            timeLimit: 480,
            checklist: [
                "Подготовить препарат и шприц",
                "Определить точку введения",
                "Обработать операционное поле",
                "Провести местную анестезию",
                "Ввести иглу в полость сустава",
                "Провести аспирационную пробу",
                "Ввести лекарственный препарат",
                "Извлечь иглу",
                "Наложить асептическую повязку",
                "Дать рекомендации пациенту"
            ]
        },
        {
            id: 6,
            title: "Снятие швов",
            description: "Техника снятия послеоперационных швов",
            timeLimit: 300,
            checklist: [
                "Подготовить инструменты",
                "Обработать операционное поле",
                "Захватить узел шва пинцетом",
                "Подсечь шовный материал",
                "Аккуратно извлечь шов",
                "Оценить состояние раны",
                "Обработать рану антисептиком",
                "Наложить асептическую повязку",
                "Дать рекомендации по уходу",
                "Записать в медицинскую карту"
            ]
        },
        {
            id: 7,
            title: "Пункция плевральной полости",
            description: "Техника диагностической плевральной пункции",
            timeLimit: 600,
            checklist: [
                "Подготовить набор для пункции",
                "Определить точку пункции",
                "Обработать операционное поле",
                "Провести местную анестезию",
                "Проколоть кожу и подкожную клетчатку",
                "Медленно продвигать иглу",
                "Получить плевральную жидкость",
                "Извлечь иглу",
                "Наложить асептическую повязку",
                "Отправить материал на исследование"
            ]
        },
        {
            id: 8,
            title: "Ларингоскопия",
            description: "Техника непрямой ларингоскопии",
            timeLimit: 300,
            checklist: [
                "Подготовить ларингоскоп",
                "Объяснить пациенту процедуру",
                "Попросить пациента высунуть язык",
                "Обернуть язык марлевой салфеткой",
                "Ввести ларингоскоп в ротоглотку",
                "Осмотреть гортань и голосовые связки",
                "Оценить подвижность связок",
                "Выявить возможные патологии",
                "Аккуратно извлечь ларингоскоп",
                "Записать результаты осмотра"
            ]
        }
    ]
};

// ===== БАЗА ДАННЫХ СИТУАЦИОННЫХ ЗАДАЧ =====
const TasksDatabase = {
    nurse: [
        {
            id: 1,
            title: "Пациент с гипертоническим кризом",
            scenario: "Пациент 65 лет, доставлен в отделение с жалобами на головную боль, головокружение, тошноту. АД 210/110 мм рт.ст., ЧСС 95 уд/мин. В анамнезе гипертоническая болезнь.",
            questions: [
                {
                    question: "Какие неотложные мероприятия необходимо провести?",
                    type: "text",
                    correctAnswer: "Уложить пациента с приподнятым головным концом, обеспечить доступ свежего воздуха, измерить АД, подготовить препараты для снижения АД по назначению врача"
                },
                {
                    question: "Какой препарат можно применить сублингвально для быстрого снижения АД?",
                    type: "multiple",
                    options: ["Каптоприл", "Нифедипин", "Метопролол", "Фуросемид"],
                    correct: 0
                }
            ]
        },
        {
            id: 2,
            title: "Пациент с бронхиальной астмой",
            scenario: "Пациент 45 лет, поступил с приступом удушья. Аускультативно: сухие свистящие хрипы над всеми легочными полями. ЧД 28 в минуту, SaO2 88%.",
            questions: [
                {
                    question: "Какая неотложная помощь показана?",
                    type: "text",
                    correctAnswer: "Ингаляция сальбутамола через небулайзер, оксигенотерапия, при неэффективности - введение системных глюкокортикоидов"
                },
                {
                    question: "Какой объем кислорода необходимо подавать первоначально?",
                    type: "multiple",
                    options: ["1-2 л/мин", "3-5 л/мин", "6-8 л/мин", "10-15 л/мин"],
                    correct: 2
                }
            ]
        }
    ],
    doctor: [
        {
            id: 1,
            title: "Диагностика острого инфаркта миокарда",
            scenario: "Пациент 58 лет, жалуется на интенсивную загрудинную боль длительностью 40 минут, иррадиирующую в левую руку. АД 100/60 мм рт.ст., ЧСС 110 уд/мин. На ЭКГ подъем сегмента ST в отведениях V1-V4.",
            questions: [
                {
                    question: "Какой предварительный диагноз?",
                    type: "text",
                    correctAnswer: "Острый передне-перегородочный инфаркт миокарда"
                },
                {
                    question: "Какие неотложные мероприятия необходимо провести?",
                    type: "text",
                    correctAnswer: "Оксигенотерапия, аспирин 250-500 мг разжевать, клопидогрел 300-600 мг, морфин в/в при боли, решение вопроса о тромболитической терапии или ЧКВ"
                },
                {
                    question: "Какой препарат противопоказан при инфаркте миокарда с подъемом ST?",
                    type: "multiple",
                    options: ["Нитроглицерин", "Морфин", "Верапамил", "Аспирин"],
                    correct: 2
                }
            ]
        },
        {
            id: 2,
            title: "Пациент с желудочно-кишечным кровотечением",
            scenario: "Пациент 70 лет, доставлен с рвотой 'кофейной гущей'. Слабость, головокружение, бледность кожных покровов. АД 90/60 мм рт.ст., ЧСС 120 уд/мин. Hb 80 г/л.",
            questions: [
                {
                    question: "Какие первоочередные диагностические мероприятия?",
                    type: "text",
                    correctAnswer: "Эзофагогастродуоденоскопия, общий анализ крови, коагулограмма, группа крови и резус-фактор"
                },
                {
                    question: "Какая инфузионная терапия показана?",
                    type: "text",
                    correctAnswer: "Кристаллоиды (физиологический раствор, Рингера) для восстановления ОЦК, при необходимости - переливание эритроцитарной массы"
                },
                {
                    question: "Какой препарат можно использовать для снижения кислотности?",
                    type: "multiple",
                    options: ["Омепразол", "Дицинон", "Аминокапроновая кислота", "Викасол"],
                    correct: 0
                }
            ]
        }
    ]
};

// ===== СИСТЕМА ДОСТИЖЕНИЙ =====
const AchievementsDatabase = [
    {
        id: 1,
        name: "Первый шаг",
        description: "Пройдите первый тест",
        icon: "fas fa-play",
        condition: (stats) => stats.testsCompleted >= 1,
        xp: 50
    },
    {
        id: 2,
        name: "Упорный ученик",
        description: "Пройдите 10 тестов",
        icon: "fas fa-graduation-cap",
        condition: (stats) => stats.testsCompleted >= 10,
        xp: 200
    },
    {
        id: 3,
        name: "Теоретик",
        description: "Ответьте правильно на 100 вопросов",
        icon: "fas fa-brain",
        condition: (stats) => stats.correctAnswers >= 100,
        xp: 300
    },
    {
        id: 4,
        name: "Практик",
        description: "Завершите 5 практических станций",
        icon: "fas fa-procedures",
        condition: (stats) => stats.stationsCompleted >= 5,
        xp: 250
    },
    {
        id: 5,
        name: "Клиницист",
        description: "Решите 10 ситуационных задач",
        icon: "fas fa-tasks",
        condition: (stats) => stats.tasksCompleted >= 10,
        xp: 350
    },
    {
        id: 6,
        name: "Неутомимый",
        description: "Проведите 10 часов в обучении",
        icon: "fas fa-clock",
        condition: (stats) => stats.timeSpent >= 36000,
        xp: 500
    },
    {
        id: 7,
        name: "Стрелок",
        description: "Достигните точности 90%",
        icon: "fas fa-bullseye",
        condition: (stats) => stats.totalQuestions > 0 && (stats.correctAnswers / stats.totalQuestions) >= 0.9,
        xp: 400
    },
    {
        id: 8,
        name: "Мастер ОСКЭ",
        description: "Выполните все станции без ошибок",
        icon: "fas fa-trophy",
        condition: (stats) => stats.perfectStations >= Object.keys(StationsDatabase).reduce((acc, course) => acc + StationsDatabase[course].length, 0),
        xp: 1000
    }
];